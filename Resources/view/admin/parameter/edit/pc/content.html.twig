{% trans_default_domain 'admin.product.parameter' %}


<div class="modal-dialog modal-dialog-centered " style="max-width: 800px;">

    {% if card %}

        {% set arr_property = card.category_section_field|json_decode %}

        {{ form_start(form) }}

        <div class="modal-content p-3 border-bottom border-5 border-primary">

            <div class="modal-header ">


                <div class="d-flex gap-3">
                <div>
                    {% set img_path = card.product_image_cdn == true ? cdn_host : '' %}
                    {% set product_image_ext = card.product_image_cdn == true ? 'small.'~card.product_image_ext : card.product_image_ext %}



                    <div class="icon rounded-3 bg-contain lazy p-1" style="width: 50px; height: 50px;"
                         data-bg="{{  card.product_image ? img_path ~ card.product_image ~ product_image_ext : '/assets/img/blank.svg' }}">
                    </div>
                </div>

                <div class="d-flex flex-column align-items-start">
                    <h5 class="modal-title d-flex align-items-center gap-3">

                        {{ card.product_name }}

                        {# Значение торгового предложения #}
                        {{ card.product_offer_value|call_twig_func(card.product_offer_reference) }}
                        {# Постфикс торгового предложения #}
                        {{ card.product_offer_postfix }}

                        {# Значение множественного варианта ТП #}
                        {{ card.product_variation_value|call_twig_func(card.product_variation_reference) }}
                        {# Постфикс множественного варианта #}
                        {{ card.product_variation_postfix }}


                        {# Значение модификации множественного варианта ТП #}
                        {{ card.product_modification_value|call_twig_func(card.product_modification_reference) }}
                        {# Постфикс модификации #}
                        {{ card.product_modification_postfix }}

                        {# Свойства, учавствующие в названии #}
                        {% for name_property in arr_property | filter(props => props.field_name == true) %}
                            {{ name_property.field_value|call_twig_func(name_property.field_type) }}
                        {% endfor %}

                    </h5>

                    <div class="d-flex align-items-center gap-3">
                        <span class="small">Артикул: {{ card.product_article }}</span>

                        {# Свойства, учавствующие в превью карточки #}
                        {% for name_property in  arr_property | filter(props => props.field_card is defined and props.field_card == true) %}
                            {{ name_property.field_value|call_twig_func(name_property.field_type~'_render') }}
                        {% endfor %}
                    </div>

                </div>
                </div>


            </div>

            <div class="modal-body p-3">

                 {# Длина , см #}
                {{ form_row(form.length, { label: 'Длина , см' }) }}

                {# Ширина, см #}
                {{ form_row(form.width, { label: 'Ширина, см' }) }}

                {# Высота, см #}
                {{ form_row(form.height, { label: 'Высота, см' }) }}

                {# Вес, кг. #}
                {{ form_row(form.weight, { label: 'Вес, кг' }) }}

            </div>


            <div class="modal-footer ">
                {# {{ form_widget(form.comment, { attr: { placeholder : 'Комментарий'} }) }} #}

                <div class="mt-3 gap-3 d-flex">
                    {# Отмена #}
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">
                        {{ 'btn.cancel'|trans({}, 'core.btn') }}
                    </button>

                    {# Сохранить #}
                    {{ form_widget(form.product_stock_parameter, { label: '
                    <span>'~ 'btn.save'|trans({}, 'core.btn') ~'</span>
                    <span class="spinner-border spinner-border-sm vertical-middle d-none"></span>
			    '}) }}
                </div>
            </div>


        </div>

        {{ form_end(form) }}


    {% else %}

        <div class="modal-content p-3 border-bottom border-5 border-primary">

            <div class="modal-header">
                <h5 class="modal-title">
                    Ошибка товара
                </h5>
            </div>

            <div class="modal-bodyp-3">
                Данного товара не существует!
            </div>


            <div class="modal-footer ">
                <div class="mt-3 gap-3 d-flex">
                    {# Отмена #}
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">
                        {{ 'btn.cancel'|trans({}, 'core.btn') }}
                    </button>
                </div>
            </div>


        </div>

    {% endif %}

</div>
